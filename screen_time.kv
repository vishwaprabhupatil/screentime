#:kivy 2.1.0
#:import dp kivy.metrics.dp

<NeonButton@Button>:
    size_hint_y: None
    height: dp(50)
    font_size: "18sp"
    background_normal: ""
    background_color: 0, 0, 0, 0
    color: 1, 1, 1, 1
    canvas.before:
        Color:
            rgba: 0.2, 0.5, 1, 1
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [25, 25, 25, 25]

<UsageCard@BoxLayout>:
    app_name: ""
    minutes: ""
    orientation: "vertical"
    size_hint_y: None
    height: dp(60)
    padding: dp(8)
    spacing: dp(2)
    canvas.before:
        Color:
            rgba: 0.12, 0.12, 0.18, 1
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [15, 15, 15, 15]
    Label:
        text: root.app_name
        font_size: "15sp"
        color: 1, 1, 1, 1
        halign: "left"
        valign: "middle"
        text_size: self.size
    Label:
        text: root.minutes
        font_size: "12sp"
        color: 0.7, 0.7, 0.9, 1
        halign: "left"
        valign: "middle"
        text_size: self.size

ScreenManager:
    LoginScreen:
        name: "login"
    ParentLoginScreen:
        name: "parent_login"
    ChildLoginScreen:
        name: "child_login"
    ChildScreen:
        name: "child"
    ParentScreen:
        name: "parent"

<LoginScreen>:
    canvas.before:
        Color:
            rgba: 0.02, 0.02, 0.06, 1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: "vertical"
        padding: dp(25)
        spacing: dp(25)

        Label:
            text: "Screen Time App"
            font_size: "32sp"
            color: 1, 1, 1, 1
            bold: True

        Label:
            text: "Who is using this device?"
            font_size: "18sp"
            color: 0.7, 0.7, 0.9, 1

        NeonButton:
            text: "I am a Parent"
            on_release: app.root.current = "parent_login"

        NeonButton:
            text: "I am a Child"
            on_release: app.root.current = "child_login"

<ParentLoginScreen>:
    canvas.before:
        Color:
            rgba: 0.02, 0.02, 0.06, 1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: "vertical"
        padding: dp(20)
        spacing: dp(15)

        Label:
            text: "Parent Login / Register"
            font_size: "24sp"
            color: 1, 1, 1, 1

        TextInput:
            id: parent_email
            hint_text: "Parent Email"
            multiline: False
            size_hint_y: None
            height: dp(45)
            background_color: 1, 1, 1, 0.2
            foreground_color: 1, 1, 1, 1
            cursor_color: 1, 1, 1, 1

        TextInput:
            id: parent_password
            hint_text: "Password"
            password: True
            multiline: False
            size_hint_y: None
            height: dp(45)
            background_color: 1, 1, 1, 0.2
            foreground_color: 1, 1, 1, 1
            cursor_color: 1, 1, 1, 1

        NeonButton:
            text: "Login / Register"
            on_release: root.do_login()

        Label:
            text: root.family_key_label
            font_size: "14sp"
            color: 0.7, 0.9, 0.9, 1

        NeonButton:
            text: "Back"
            on_release: app.root.current = "login"

<ChildLoginScreen>:
    canvas.before:
        Color:
            rgba: 0.02, 0.02, 0.06, 1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: "vertical"
        padding: dp(20)
        spacing: dp(15)

        Label:
            text: "Child Login / Register"
            font_size: "24sp"
            color: 1, 1, 1, 1

        TextInput:
            id: child_email
            hint_text: "Child Email"
            multiline: False
            size_hint_y: None
            height: dp(45)
            background_color: 1, 1, 1, 0.2
            foreground_color: 1, 1, 1, 1
            cursor_color: 1, 1, 1, 1

        TextInput:
            id: child_password
            hint_text: "Password"
            password: True
            multiline: False
            size_hint_y: None
            height: dp(45)
            background_color: 1, 1, 1, 0.2
            foreground_color: 1, 1, 1, 1
            cursor_color: 1, 1, 1, 1

        TextInput:
            id: family_key
            hint_text: "Family Key (from parent)"
            multiline: False
            size_hint_y: None
            height: dp(45)
            background_color: 1, 1, 1, 0.2
            foreground_color: 1, 1, 1, 1
            cursor_color: 1, 1, 1, 1

        NeonButton:
            text: "Login / Register"
            on_release: root.do_login()

        Label:
            text: root.status_msg
            font_size: "14sp"
            color: 0.7, 0.9, 0.9, 1

        NeonButton:
            text: "Back"
            on_release: app.root.current = "login"

<ChildScreen>:
    canvas.before:
        Color:
            rgba: 0.02, 0.02, 0.06, 1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: "vertical"
        padding: dp(20)
        spacing: dp(10)

        Label:
            text: "Child Dashboard"
            font_size: "24sp"
            color: 1, 1, 1, 1

        NeonButton:
            text: "Refresh Usage (Last 24h)"
            on_release: root.update_usage()

        ScrollView:
            GridLayout:
                id: usage_grid
                cols: 1
                spacing: dp(8)
                size_hint_y: None
                height: self.minimum_height

        NeonButton:
            text: "Back"
            on_release: app.root.current = "login"

<ParentScreen>:
    canvas.before:
        Color:
            rgba: 0.02, 0.02, 0.06, 1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: "vertical"
        padding: dp(20)
        spacing: dp(10)

        Label:
            text: "Parent Dashboard"
            font_size: "24sp"
            color: 1, 1, 1, 1

        NeonButton:
            text: "Load Child Usage"
            on_release: root.load_child_usage()

        ScrollView:
            GridLayout:
                id: parent_usage_grid
                cols: 1
                spacing: dp(8)
                size_hint_y: None
                height: self.minimum_height

        NeonButton:
            text: "Back"
            on_release: app.root.current = "login"
